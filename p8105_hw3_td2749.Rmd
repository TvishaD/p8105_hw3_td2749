---
title: "p8105_hw3_td2749"
author: "Tvisha R. Devavarapu"
date: "2022-10-07"
output: github_document
---

```{r Setting up}
library(tidyverse)
library(ggplot2)
```

## Problem 2: Accelerometer Data

*Task 2.1*: Load, tidy, and otherwise wrangle the data. Your final dataset should include all originally observed variables and values; have useful variable names; include a weekday vs weekend variable; and encode data with reasonable variable classes. Describe the resulting dataset (e.g. what variables exist, how many observations, etc).

```{r accel_data pivot_long version.}
accel_data = 
  read_csv("./data/accel_data.csv") %>%
  janitor::clean_names() %>%
  mutate(day_type = ifelse(day %in% c("Saturday","Sunday"), "weekend", "weekday")) %>% 
  mutate(day = fct_relevel(day, "Monday", "Tuesday", "Wednesday", "Thursday",
                                  "Friday", "Saturday", "Sunday")) %>%
  pivot_longer(activity_1:activity_1440, names_to = "minute_of_day",
               values_to = "activity_count") %>% 
  group_by(week, day) %>%
  mutate(total_activity_count = sum(activity_count)) %>% 
  ungroup() %>% 
  pivot_wider(names_from = minute_of_day, values_from = activity_count) %>% 
  select(week, day_id, day, day_type, total_activity_count, everything())
```
*Description*: Without losing any of the originally observed variables and values, the resultant `accel_data` df contains 35 unique rows of observations

*Task 2.2*: Traditional analyses of accelerometer data focus on the total activity over the day. Using your tidied dataset, aggregate across minutes to create a total activity variable for each day, and create a table showing these totals. Are any trends apparent?
```{r Total Activity - Table and Graph}
total_activity_table = 
  accel_data %>% 
  group_by(week, day) %>% 
  summarize(total_activity_count) %>% 
  pivot_wider(names_from = day, values_from = total_activity_count)

accel_data %>%
  ggplot(aes(x = day, y = total_activity_count, color = week, group = week)) +
  geom_point() +
  geom_line()
```

*Task 2.3*: Accelerometer data allows the inspection activity over the course of the day. Make a single-panel plot that shows the 24-hour activity time courses for each day and use color to indicate day of the week. Describe in words any patterns or conclusions you can make based on this graph.
```{r 24 Hour Plot}
accel_data %>%
  pivot_longer(activity_1:activity_1440, names_to = "minute_of_day", 
               names_prefix = "activity_", values_to = "activity_count") %>% 
  ggplot(aes(x = minute_of_day, y = activity_count, color = day)) +
  geom_point() 
```


                                                              