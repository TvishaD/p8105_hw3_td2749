---
title: "p8105_hw3_td2749"
author: "Tvisha R. Devavarapu"
date: "2022-10-07"
output: github_document
---

```{r Setting up, message = FALSE}
library(tidyverse)
library(ggplot2)
```

```{r Setting up figure dimensions}
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)
```


## Problem 2: Accelerometer Data

**Task 2.1**: Load, tidy, and otherwise wrangle the data. Your final dataset should include all originally observed variables and values; have useful variable names; include a weekday vs weekend variable; and encode data with reasonable variable classes. Describe the resulting dataset (e.g. what variables exist, how many observations, etc).

```{r accel_data set up}
accel_data = 
  read_csv("./data/accel_data.csv") %>%
  janitor::clean_names() %>%
  mutate(day_type = ifelse(day %in% c("Saturday","Sunday"), "weekend", "weekday")) %>% 
  mutate(day = fct_relevel(day, "Monday", "Tuesday", "Wednesday", "Thursday",
                                  "Friday", "Saturday", "Sunday")) %>%
  pivot_longer(activity_1:activity_1440, names_to = "minute_of_day",
               values_to = "activity_count") %>% 
  group_by(week, day) %>%
  mutate(total_activity_count = sum(activity_count)) %>% 
  ungroup() %>% 
  pivot_wider(names_from = minute_of_day, values_from = activity_count) %>% 
  select(week, day_id, day, day_type, total_activity_count, everything())
```
**Description**: Without losing any of the originally observed variables and values, the resultant `accel_data` df contains 35 unique rows of observations. Each row represents a day (1-35 days). The final df has 1445 columns of variables: `week` consists of values from 1-5 depicting the respective week of observation, `day_id` and `day` identify the unique days of observation (all 7 days of a week * 5 weeks = 35 days = 35 rows), `day_type` indicates whether a given day is a weekend or a weekday, `total_activity_count` represents the sums across each minute's activity counts over a given day (sum of 1140 (24*60) values), and `activity_1` to `activity_1440` represent the activity counts across each minute. 


**Task 2.2**: Traditional analyses of accelerometer data focus on the total activity over the day. Using your tidied dataset, aggregate across minutes to create a total activity variable for each day, and create a table showing these totals. Are any trends apparent?
```{r Total Activity - Table and Graph}
total_activity_table = 
  accel_data %>% 
  group_by(week, day) %>% 
  summarize(total_activity_count) %>% 
  pivot_wider(names_from = day, values_from = total_activity_count)

total_activity_table

accel_data %>%
  ggplot(aes(x = day, y = total_activity_count, color = week, group = week)) +
  geom_point() +
  geom_line() +
  scale_colour_gradientn(colours = c("#88CCEE", "#CC6677", "#DDCC77", "#117733", "#332288")) +
  labs(title = "Total Activity Count Vs. Day: Across 5 Weeks",
       x = "Day",
       y = "Total Activity Count") +
  theme(plot.title = element_text(hjust = 0.5))
```
**Description**: From the table and graph generated above, here are some observed trends:

* Compared to other weeks, activity is relatively more consistent throughout week 3.
* Activity on Tuesday seems to be most consistent across all five weeks.
* Generally upward trending activity between Tuesday and Thursday of weeks 1, 2, and 3.
* Activity on Saturday of weeks 4 and 5 seems extremely low, even assuming lower than usual activity. This could be a result of the accelerometer not being worn on these days. 
* Across all weeks, activity was greater on Wednesday than on Tuesday and on Friday than on Thursday (apart from week 4). 
* Apart from week 4, Fridays seem to have consistently high total activities.

NOTE: I'm aware that `week` is in continual format (by virtue of being made up of numeric values.) I tried converting it into character (to use it as a categorical variable) but that's not letting me plot this graph. I will learn of a way to rectify this situation! 


**Task 2.3**: Accelerometer data allows the inspection activity over the course of the day. Make a single-panel plot that shows the 24-hour activity time courses for each day and use color to indicate day of the week. Describe in words any patterns or conclusions you can make based on this graph.
```{r 24 Hour Plot}
accel_data %>%
  pivot_longer(activity_1:activity_1440, names_to = "minute_of_day", 
               names_prefix = "activity_", values_to = "activity_count") %>% 
  mutate(minute_of_day = as.numeric(minute_of_day)) %>% 
  ggplot(aes(x = minute_of_day, y = activity_count, color = day)) +
  geom_point(alpha = 0.5) +
  scale_x_continuous(
    breaks = c(360, 720, 1080, 1440), 
    labels = c("6 AM", "12 PM", "6 PM", "12 AM")) +
  labs(title = "Activity Count Vs. Hour",
       x = "Hour",
       y = "Activity Count",
       caption = "Composite: Monday through Sunday; across 5 weeks") +
  theme(plot.title = element_text(hjust = 0.5),
        plot.caption = element_text(hjust = 0.5))
```


                                                              